#!/bin/bash 

. user-provided-env.sh

echo `pwd`

echo HADOOP FOLDER: $HADOOP_PREFIX
echo HADOOP VERSION: $HADOOP_VERSION
JAR_PREFIX=$HADOOP_PREFIX/share/hadoop/
ENVIRONMENTS_PREFIX=`pwd`/environments
AOP_PREFIX=`pwd`
JOBS_PREFIX=`pwd`/jobs
PACKAGE_PREFIX=`pwd`/package
LIB_PREFIX=`pwd`/lib

HADOOP_CORE_FILE_PATH=$JAR_PREFIX/common/hadoop-common-2.7.1.jar
HADOOP_MAPRED_FILE_PATH=$JAR_PREFIX/mapreduce/hadoop-mapreduce-client-core-2.7.1.jar
HADOOP_HDFS_FILE_PATH=$JAR_PREFIX/hdfs/hadoop-hdfs-2.7.1.jar
HADOOP_YARN_RESOURCEMANAGER_FILE_PATH=$JAR_PREFIX/yarn/hadoop-yarn-server-resourcemanager-2.7.1.jar
HADOOP_YARN_CLIENT_FILE_PATH=$JAR_PREFIX/yarn/hadoop-yarn-client-2.7.1.jar


HADOOP_CORE_FILE=$(basename $HADOOP_CORE_FILE_PATH)
HADOOP_MAPRED_FILE=$(basename $HADOOP_MAPRED_FILE_PATH)
HADOOP_HDFS_FILE=$(basename $HADOOP_HDFS_FILE_PATH)
HADOOP_YARN_RESOURCEMANAGER_FILE=$(basename $HADOOP_YARN_RESOURCEMANAGER_FILE_PATH)
HADOOP_YARN_CLIENT_FILE=$(basename $HADOOP_YARN_CLIENT_FILE_PATH)


RELEASE=`md5sum $HADOOP_CORE_FILE_PATH | cut -d " " -f 1`
RELEASE_PATH=$ENVIRONMENTS_PREFIX/$RELEASE
INSTRUMENTATION_PATH=$RELEASE_PATH/instrumentation

PATCHED_HADOOP_CORE_FILE=$RELEASE_PATH/$HADOOP_CORE_FILE
PATCHED_HADOOP_MAPRED_FILE=$RELEASE_PATH/$HADOOP_MAPRED_FILE
PATCHED_HADOOP_HDFS_FILE=$RELEASE_PATH/$HADOOP_HDFS_FILE
PATCHED_HADOOP_YARN_RESOURCEMANAGER_FILE=$RELEASE_PATH/$HADOOP_YARN_RESOURCEMANAGER_FILE
PATCHED_HADOOP_YARN_CLIENT_FILE=$RELEASE_PATH/$HADOOP_YARN_CLIENT_FILE
echo $PATCHED_HADOOP_YARN_CLIENT_FILE


SOURCE_AJC=`pwd`/src/$HADOOP_VERSION
echo SOURCE_AJC:$SOURCE_AJC


echo RELEASE: $RELEASE

echo ""
